# Week 9 Applied Sheet - Solutions

## Introduction

**Useful Advice:** The following solutions pertain to the theoretical problems given in the applied classes. You are strongly advised to attempt the problems thoroughly before looking at these solutions. Simply reading the solutions without thinking about the problems will rob you of the practice required to be able to solve complicated problems on your own. You will perform poorly on the exam if you simply attempt to memorise solutions to these problems. Thinking about a problem, even if you do not solve it will greatly increase your understanding of the underlying concepts. Solutions are typically not provided for Python implementation questions. In some cases, pseudocode may be provided where it illustrates a particular useful concept.

---

## Problems

### Problem 1
**Question:** Let G be a flow network and let f be a valid flow on G. Prove that the net outflow out of s is equal to the net inflow into t.

**Solution:**
Suppose the set of all vertices is V. We know that the flow of every cut is equal to the flow of the network. Therefore the flow of the cut ({s}, V \ {s}) - which is the flow out of s - must equal the flow of the cut (V \ {t}, {t}) - which is the flow into t.

---

### Problem 2
**Question:** Consider a variant of the maximum flow problem in which we allow for multiple source vertices and multiple sink vertices. We retain all of the capacity and flow conservation constraints of the original maximum flow problem. As in the original problem, all of the sources and sinks are excluded from the flow conservation constraint. Describe a simple method for solving this problem.

**Solution:**
We create a new graph by adding a "super-source" vertex and a "super-sink" vertex. The super source is connected to each source by an edge with capacity equal to the total capacities of all the outgoing edges from that source. Similarly, each sink is connected by an edge to the super sink, and the capacity of that edge is equal to the total capacities of all incoming edges to that sink. We then solve the flow problem on this new graph as normal.

---

### Problem 3
**Question:** Given a list of n integers r₁, r₂, ..., rₙ and m integers c₁, c₂, ..., cₘ, we wish to determine whether there exists an n × m matrix X consisting of zeros and ones whose row sums are r₁, r₂, ..., rₙ respectively and whose column sums are c₁, c₂, ..., cₘ respectively. It is assumed that the sum of the r's is equal to the sum of the c's (otherwise it is trivially impossible to satisfy the constraints). Describe an algorithm for solving this problem by using a flow network.

**Solution:**
Construct a flow network as follows: Create two sets of vertices, A and B. Each vertex in A (a₁, a₂, ..., aₙ) corresponds to one of the n rows, and each vertex in B (b₁, b₂, ..., bₘ) corresponds to one of the m columns. Add a source and a sink. For 1 ≤ i ≤ n, add an edge from the source to aᵢ with capacity rᵢ. For each 1 ≤ j ≤ m, add an edge from vertex bⱼ to the sink with capacity cⱼ. Add edges eᵢ,ⱼ between every pair of vertices (aᵢ, bⱼ) with capacity 1. Determine the maximum flow in this network using the Ford-Fulkerson method.

If all outgoing edges of the source are saturated, then we can construct such a matrix, and moreover, the elements Xᵢ,ⱼ of the matrix are equal to the flows along eᵢ,ⱼ. If any outgoing edge from the source is not saturated, such a matrix does not exist.

To see why this method works, consider the flows into and out of the aᵢ vertices for integer-valued flows (such as the ones generated by the Ford-Fulkerson method when executing on a flow network with integer capacities). We notice that a row has rᵢ 1s if, and only if, the vertex aᵢ has a total outflow of rᵢ (because each edge out of aᵢ corresponds to one of the values in column i, and all the edges from aᵢ have capacity 1), but this is only possible if the flow from the source to aᵢ is exactly rᵢ because the only edge that flows into aᵢ is from the source. These edges have capacity rᵢ, so they all need to be saturated.

**Additional Note:**
After you have studied circulation with demands in the second seminar about network flow, please note that they can be used to model this problem in much simpler terms as there is no need to include additional source and sink nodes (and their outgoing/incoming edges): you simply put the nodes aᵢ with demand −rᵢ, the nodes bⱼ with demand cⱼ and solve the circulation with demands to check if there is a feasible solution. The additional nodes, edges and checks in the solution in the previous paragraphs are just implicitly doing the reduction of the circulation with demands problem to the maximum flow problem.

---

### Problem 4
**Question:** Consider the problem of allocating a set of jobs to one of two supercomputers. Each job must be allocated to exactly one of the two computers. The two computers are configured slightly differently, so for each job, you know how much it will cost on each of the computers. There is an additional constraint. Some of the jobs are related, and it would be preferable, but not required, to run them on the same computer. For each pair of related jobs, you know how much more it will cost if they are run on separate computers. Give an efficient algorithm for determining the optimal way to allocate the jobs to the computers, where your goal is to minimise the total cost.

**Solution:**
Create a graph with (bidirectional) edges between related jobs, whose capacities are the cost to separate them. Add edges from s to all jobs with a capacity equal to the cost to run on computer 1, and edges from all jobs to t with capacity equal to the cost to run on computer 2. The minimum cut will be the best total cost since you are paying to either put the job on computer 1 or 2, and paying for related jobs that are cut from each other when assigned to different computers. But be careful: when considering the minimum cut, all the jobs that end up in the S side of the cut are executed on computer 2, while all the jobs that end up in the T side of the cut are executed on computer 1.

---

### Problem 5
**Question:** Consider a variant of network flows in which vertices also have capacities. That is for each vertex except s and t, there is a maximum amount of flow that can enter and leave it. Describe a simple transformation that can be made to this problem so that its maximum flow can be solved using an ordinary maximum flow algorithm¹.

¹Do not try to modify the Ford-Fulkerson algorithm. In general, it is always safer when solving a problem to reduce the problem to another known problem by transforming the input, rather than modifying the algorithm for the related problem.

**Solution:**
For each non-source non-sink vertex v, do the following: Create two new vertices vᵢₙ and vₒᵤₜ. Take all the incoming edges to v and replace v with vᵢₙ. Take all the outgoing edges from v and replace v with vₒᵤₜ. Create an edge from vᵢₙ to vₒᵤₜ with capacity equal to the capacity of v. Delete v from the network. Now we can solve for the maximum flow in this graph, and the solution will be the maximum flow in the original graph as well.

---

### Problem 6
**Question:** Two paths in a graph are edge disjoint if they have no edges in common. Given a directed graph, we would like to determine the maximum number of edge-disjoint paths from vertex s to vertex t.

(a) Describe how to determine the maximum number of edge-disjoint s − t paths.

(b) What is the time complexity of this approach?

(c) How could we modify this approach to find vertex-disjoint paths (i.e. paths with no vertices in common)?

**Solution:**

(a) Given a directed graph G, create a flow network G' from G as follows: Let s be the source, and t be the sink. Give every edge a capacity of 1. Now we can run the maximum flow algorithm, and the resulting flow is the number of edge-disjoint paths.

This works because the number of edge-disjoint paths that pass through a vertex v is at most min(indegree(v), outdegree(v)). The maximum flow through a vertex v is the same value, because all edges are capacity 1.

(b) The time complexity of Ford-Fulkerson is bounded by O(Ef) where E is the number of edges and f is the maximum flow. Here, the maximum flow is upper-bounded by the outdegree of s, so the complexity is O(E × outdegree(s)) which is bounded by O(EV).

(c) Create the flow network as specified in part a), but add capacities of 1 for each vertex, and then perform the transform described in the solution to problem 5. This ensures that the flow through each vertex is at most 1, whereas before the flow through a vertex was equal to the number of paths through it.

---

## Supplementary Problems

### Problem 7
**Question:** You are a radio station host and are in charge of scheduling the songs for today's program. Every song can be classified as being from a particular era, and a particular genre. Your boss has given you a strict set of requirements that the songs must conform to. No song can be played more than once during the program. Among the songs chosen, for each of the n eras 1 ≤ i ≤ n, you must play exactly eᵢ songs of that era, and for each of the m genres 1 ≤ j ≤ m, you must play exactly gⱼ songs from that genre. Of course, Σᵢ eᵢ = Σⱼ gⱼ. Devise an algorithm that given a list of all of the songs you could choose from, their era and their genre, determines a subset of them that satisfies the requirements, or determines that it is not possible.

**Solution:**
Make a bipartite graph with vertices a₁, ..., aₙ corresponding to eras, and vertices b₁, ..., bₘ corresponding to genres. For each combination of era i and genre j, add an edge from aᵢ to bⱼ with a capacity equal to the number of distinct songs that belong to that combination of era and genre (think about how this would change if a certain amount of repetitions of each song were possible). Add a source with outgoing edges to each genre vertex aᵢ with capacity eᵢ (where 1 ≤ i ≤ n). Add a sink vertex, with an edge from each vertex bⱼ to the sink with capacity gⱼ (where 1 ≤ j ≤ m). Run the Ford-Fulkerson method on this graph, and if a maximum flow has value Σᵢ eᵢ = Σⱼ gⱼ, then it is possible to play songs in the required combination. Otherwise it is not. The flow along the edges from aᵢ to bⱼ will tell you how many songs from a particular combination of era and genre should be played (which you can then easily select without repetition by looking at your input list).

---

### Problem 8
**Question:** Implement the Ford-Fulkerson method using:
• DFS for finding augmenting paths.
• BFS for finding augmenting paths.

**Solution:** [Implementation problem - solution not provided as per document conventions]

---

**End of Document**